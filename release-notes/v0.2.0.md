# build-kg v0.2.0 — Generic Knowledge Graphs, Multi-Agent Support

**Date:** 2026-02-20
**License:** Apache 2.0

---

## Summary

build-kg is no longer a regulatory-only tool. v0.2.0 transforms it into a **generic knowledge graph builder** that works with **any topic** — technical, scientific, educational, or anything else. Your coding agent auto-generates the ontology, discovers sources, and builds the graph end-to-end.

This release also adds first-class support for multiple coding agents. The `/build-kg` skill now ships as a proper skill file following each platform's conventions.

```
/build-kg kubernetes networking
/build-kg machine learning optimization algorithms
/build-kg distributed systems consensus algorithms
```

---

## Highlights

### Any Topic, Auto-Generated Ontology

v0.1.0 used a hardcoded Provision → Requirement → Constraint ontology. v0.2.0 lets the agent **design the ontology for your topic** — node types, edge types, properties, and JSON schema are all generated dynamically.

For "kubernetes networking", the agent generates:
```
Component              "kube-proxy"
  |                    type: proxy, layer: L4
  |
  +-- USES ----------> Concept: "iptables"
  |                    category: packet filtering
  |
  +-- CONFIGURES ----> Configuration: "service.spec.type"
                       default_value: ClusterIP, scope: service
```

### Multi-Agent Skill Support

The `/build-kg` skill now ships as proper skill files for each platform:

| Agent | File | Format |
|-------|------|--------|
| Claude Code | `.claude/skills/build-kg/SKILL.md` | Skills format with YAML frontmatter |
| OpenAI Codex | `AGENTS.md` | Project context with pipeline instructions |
| Other agents | Either file | Point your agent at either file |

No extra installation step — cloning the repo is all it takes.

### Anthropic as Default LLM Provider

The default LLM provider is now **Anthropic** (Claude Haiku 3.5). OpenAI remains fully supported as an alternative. A new `llm.py` abstraction layer handles provider-specific API differences for both sync and batch parsing.

---

## What's New

### Agent Skills

- **`.claude/skills/build-kg/SKILL.md`** — Claude Code skill with YAML frontmatter (`disable-model-invocation: true`, `allowed-tools`, `argument-hint: [topic]`)
- **`AGENTS.md`** — OpenAI Codex agent instructions with project context, setup, architecture, and pipeline reference
- Skill files are auto-detected by each platform when the project is opened

### Ontology System

- **Automatic ontology generation** — the agent designs node types, edge types, and properties for any topic
- **`OntologyConfig`**, **`NodeDef`**, **`EdgeDef`** Pydantic models in `domain.py`
- **`--ontology` flag** on `build-kg-parse`, `build-kg-parse-batch`, and `build-kg-setup`
- **Generic JSON format**: `{entities: [...], relationships: [...]}` for LLM output
- **`load_ontology()`** function for loading standalone YAML ontology files
- **Ontology-driven graph setup** — `setup_graph.py` creates vertex labels from ontology definitions

### LLM Provider Abstraction

- **`llm.py`** — new module that abstracts Anthropic and OpenAI APIs behind a unified interface
- **`LLM_PROVIDER`** env var (default: `anthropic`) selects the provider
- **`ANTHROPIC_API_KEY`**, **`ANTHROPIC_MODEL`** env vars for Anthropic configuration
- Both sync and batch parsing work with either provider
- `verify.py` tests whichever provider is configured

### Domain Profiles

- **Profile inheritance** via `extends` field for DRY configuration
- **`DOMAIN`** env var and `--domain` CLI flag for profile selection
- **Custom profiles** via file path (`--domain /path/to/profile.yaml`)
- **`build-kg-domains`** command to list available profiles
- Shared `build_prompt()` function routes between ontology-driven and legacy prompt templates

### Documentation

- **Consolidated from 13 HTML pages to 3**: `index.html` (landing), `docs.html` (all documentation), `tutorial.html` (hands-on guide)
- **Skill installation docs** — each page explains how the skill activates for Claude Code, Codex, and other agents
- **Generic positioning** — all documentation updated to reflect any-topic support
- **Removed CLI-only documentation** — pipeline tools are documented as part of the skill, not standalone commands

---

## What Changed

### Breaking Changes

- **Default LLM provider is now Anthropic** (was OpenAI). Set `LLM_PROVIDER=openai` to use OpenAI.
- **`ANTHROPIC_API_KEY` is now required by default** (was `OPENAI_API_KEY`). Set your Anthropic key or switch to `LLM_PROVIDER=openai`.
- **`jurisdiction`, `authority`, `doc_type` columns are now nullable** in `source_document` and `source_fragment` tables (were required enums).
- **`market_code` and `doc_type` enums removed** from `db/init.sql` — columns are now freeform TEXT.

### Renamed

- `RegulatoryParser` → `KGParser` (backward-compatible alias kept)

### Removed (from documentation only)

- Regulatory-specific examples and references (GDPR, CFIA, FDA, SFA, AML, KYC)
- Hardcoded jurisdiction list (CA, US, EU, SG, etc.) — jurisdiction is now freeform
- CLI-only usage documentation — the skill is the primary interface
- 10 standalone HTML doc pages (architecture, reference-crawl/chunk/load/parse, manifest-format, troubleshooting, tutorial-quickstart, tutorial-singapore) — content absorbed into `docs.html` and `tutorial.html`
- `site/` directory (landing page moved to `docs/index.html`)

### Python source code unchanged

- All CLI tools (`build-kg-crawl`, `build-kg-chunk`, `build-kg-load`, `build-kg-parse`, `build-kg-parse-batch`, `build-kg-setup`, `build-kg-verify`) remain fully functional
- Domain profile YAML files (food-safety, financial-aml, data-privacy) remain in the package
- All regulatory parsing logic remains in the codebase for backward compatibility

---

## Tech Stack

| Component | v0.1.0 | v0.2.0 |
|-----------|--------|--------|
| LLM parsing | OpenAI GPT-4o-mini | Anthropic Claude Haiku 3.5 (default) or OpenAI GPT-4o-mini |
| Ontology | Hardcoded (Provision/Requirement/Constraint) | Auto-generated per topic |
| Agent support | Claude Code only | Claude Code + OpenAI Codex + other agents |
| Skill format | `.claude/commands/` (legacy) | `.claude/skills/` (recommended) + `AGENTS.md` |
| Documentation | 13 HTML pages | 3 consolidated pages |

---

## Cost

Unchanged from v0.1.0. Only LLM API calls during parsing.

| Fragments | Sync | Batch (50% off) |
|-----------|------|-----------------|
| 100 | ~$0.03 | ~$0.015 |
| 1,000 | ~$0.30 | ~$0.15 |
| 5,000 | ~$1.50 | ~$0.75 |

---

## Getting Started

```bash
git clone https://github.com/agtm1199/build-kg.git
cd build-kg
make setup
cp .env.example .env
# Set ANTHROPIC_API_KEY in .env
make verify
```

Then in your coding agent:

```
/build-kg kubernetes networking
```

---

## Stats

- 50 tracked files
- 12,580 lines
- 7 CLI commands
- 3 documentation pages
- 2 agent skill files (Claude Code + Codex)

---

## Links

- Repository: https://github.com/agtm1199/build-kg
- Documentation: `docs/docs.html`
- Tutorial: `docs/tutorial.html`
- License: Apache 2.0
