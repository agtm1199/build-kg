<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manifest Format - build-kg</title>
<style>
  :root {
    --bg: #0d1117; --surface: #161b22; --border: #30363d; --text: #c9d1d9; --text-muted: #8b949e;
    --heading: #f0f6fc; --link: #58a6ff; --accent: #1f6feb; --green: #3fb950; --orange: #d29922;
    --red: #f85149; --purple: #bc8cff; --code-bg: #0d1117; --inline-code-bg: #1c2128;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'JetBrains Mono', 'Fira Code', 'SF Mono', 'Cascadia Code', 'Consolas', 'Liberation Mono', monospace; background: var(--bg); color: var(--text); line-height: 1.6; font-size: 16px; }
  .container { max-width: 960px; margin: 0 auto; padding: 2rem 1.5rem; }
  .hero { text-align: center; padding: 3rem 0; border-bottom: 1px solid var(--border); margin-bottom: 2rem; }
  .hero h1 { font-size: 2.5rem; color: var(--heading); margin-bottom: 0.5rem; letter-spacing: -0.02em; }
  .hero .tagline { font-size: 1.2rem; color: var(--text-muted); margin-bottom: 1.5rem; }
  .hero .badges { display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap; }
  .badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 2rem; font-size: 0.8rem; font-weight: 600; border: 1px solid var(--border); color: var(--text-muted); }
  .badge.green { border-color: var(--green); color: var(--green); }
  .badge.blue { border-color: var(--link); color: var(--link); }
  .badge.purple { border-color: var(--purple); color: var(--purple); }
  section { margin-bottom: 3rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border); }
  section:last-child { border-bottom: none; }
  h2 { font-size: 1.8rem; color: var(--heading); margin-bottom: 1rem; padding-top: 1rem; }
  h3 { font-size: 1.3rem; color: var(--heading); margin: 1.5rem 0 0.75rem; }
  h4 { font-size: 1.05rem; color: var(--heading); margin: 1.25rem 0 0.5rem; }
  p { margin-bottom: 1rem; }
  ul, ol { margin-bottom: 1rem; padding-left: 1.5rem; }
  li { margin-bottom: 0.25rem; }
  a { color: var(--link); text-decoration: none; }
  a:hover { text-decoration: underline; }
  pre { background: var(--code-bg); border: 1px solid var(--border); border-radius: 6px; padding: 1rem 1.25rem; overflow-x: auto; margin: 1rem 0; font-size: 0.875rem; line-height: 1.5; }
  code { font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace; font-size: 0.875em; }
  :not(pre) > code { background: var(--inline-code-bg); padding: 0.15em 0.4em; border-radius: 3px; font-size: 0.85em; }
  table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem; }
  th, td { text-align: left; padding: 0.6rem 0.8rem; border: 1px solid var(--border); }
  th { background: var(--surface); color: var(--heading); font-weight: 600; }
  tr:nth-child(even) { background: rgba(22, 27, 34, 0.5); }
  .callout { border-left: 3px solid var(--accent); background: var(--surface); padding: 1rem 1.25rem; border-radius: 0 6px 6px 0; margin: 1rem 0; }
  .callout.tip { border-left-color: var(--green); }
  .callout strong { display: block; margin-bottom: 0.25rem; color: var(--heading); }
  footer { text-align: center; padding: 2rem 0; color: var(--text-muted); font-size: 0.85rem; }
  @media (max-width: 700px) { .hero h1 { font-size: 2rem; } }
</style>
</head>
<body>

<nav style="position:sticky;top:0;z-index:100;background:var(--surface);border-bottom:1px solid var(--border);padding:0.75rem 1.5rem;display:flex;align-items:center;gap:1.5rem;font-size:0.9rem;backdrop-filter:blur(8px);">
  <a href="index.html" style="color:var(--heading);font-weight:700;text-decoration:none;">build-<span style="color:var(--link)">kg</span></a>
  <a href="documentation.html">Docs</a>
  <a href="guide.html">Guide</a>
  <a href="manifest-format.html" style="color:var(--heading);">Manifest Format</a>
  <a href="https://github.com/agtm1199/build-kg" style="margin-left:auto;">GitHub</a>
</nav>

<div class="container">

<!-- Hero -->
<header class="hero">
  <h1>build-kg</h1>
  <p class="tagline">Manifest Format</p>
  <div class="badges">
    <span class="badge green">Apache 2.0</span>
    <span class="badge blue">Python 3.10+</span>
    <span class="badge purple">Apache AGE</span>
  </div>
</header>

<!-- Schema Overview -->
<section id="schema-overview">
  <h2>Schema Overview</h2>
  <p>The crawl manifest (<code>crawl_manifest.json</code>) is the central configuration file for a build-kg pipeline run. It lists every source to crawl, provides metadata for each source, defines defaults, and tracks coverage.</p>
  <pre><code>{
  &quot;topic&quot;: &quot;string&quot;,
  &quot;graph_name&quot;: &quot;string&quot;,
  &quot;created_at&quot;: &quot;ISO 8601 string&quot;,
  &quot;sources&quot;: [ ... ],
  &quot;defaults&quot;: { ... },
  &quot;coverage&quot;: { ... },
  &quot;metadata&quot;: { ... }
}</code></pre>
</section>

<!-- Top-Level Fields -->
<section id="top-level-fields">
  <h2>Top-Level Fields</h2>
  <table>
    <tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr>
    <tr><td><code>topic</code></td><td>string</td><td>yes</td><td>Human-readable description of the topic (e.g., &quot;kubernetes networking&quot; or &quot;Singapore F&amp;B regulations&quot;)</td></tr>
    <tr><td><code>graph_name</code></td><td>string</td><td>yes</td><td>Apache AGE graph name. Convention: <code>reg_&lt;country&gt;_&lt;domain&gt;</code> for regulatory, <code>kg_&lt;topic&gt;</code> for generic</td></tr>
    <tr><td><code>created_at</code></td><td>string</td><td>yes</td><td>ISO 8601 timestamp of when the manifest was created</td></tr>
    <tr><td><code>sources</code></td><td>array</td><td>yes</td><td>List of source objects (see below)</td></tr>
    <tr><td><code>defaults</code></td><td>object</td><td>no</td><td>Default metadata applied when a source does not specify a field</td></tr>
    <tr><td><code>coverage</code></td><td>object</td><td>no</td><td>Tracks which sub-domains/topics are covered</td></tr>
    <tr><td><code>metadata</code></td><td>object</td><td>no</td><td>Arbitrary key-value metadata stored in the <code>metadata</code> JSONB column</td></tr>
  </table>
</section>

<!-- Source Object -->
<section id="source-object">
  <h2>Source Object</h2>
  <p>Each entry in the <code>sources</code> array describes one website to crawl.</p>
  <table>
    <tr><th>Field</th><th>Type</th><th>Required</th><th>Description</th></tr>
    <tr><td><code>source_name</code></td><td>string</td><td>yes</td><td>Short identifier used as the crawl output directory name (e.g., <code>sfa_food_regs</code>, <code>k8s_docs</code>). Must be unique within the manifest. This is the key used by the loader for source matching.</td></tr>
    <tr><td><code>url</code></td><td>string</td><td>yes</td><td>Starting URL for the crawl</td></tr>
    <tr><td><code>title</code></td><td>string</td><td>yes</td><td>Descriptive title of the document or source</td></tr>
    <tr><td><code>authority</code></td><td>string</td><td>no</td><td>Issuing organization (e.g., <code>SFA</code>, <code>CFIA</code>). Nullable for generic topics.</td></tr>
    <tr><td><code>jurisdiction</code></td><td>string</td><td>no</td><td>Jurisdiction code (e.g., SG, CA, US). Any string value. Nullable for generic topics.</td></tr>
    <tr><td><code>doc_type</code></td><td>string</td><td>no</td><td>Document type (e.g., regulation, documentation, tutorial). Any string value. Nullable for generic topics.</td></tr>
    <tr><td><code>priority</code></td><td>string</td><td>no</td><td>Priority tier: <code>P1</code>, <code>P2</code>, <code>P3</code>, or <code>P4</code></td></tr>
    <tr><td><code>sub_domains</code></td><td>array</td><td>no</td><td>List of sub-domain/topic strings this source covers</td></tr>
    <tr><td><code>depth</code></td><td>integer</td><td>no</td><td>Crawl depth override (default from priority tier)</td></tr>
    <tr><td><code>max_pages</code></td><td>integer</td><td>no</td><td>Maximum pages to crawl override (default from priority tier)</td></tr>
    <tr><td><code>delay</code></td><td>integer</td><td>no</td><td>Crawl delay in milliseconds override (default from priority tier)</td></tr>
  </table>

  <h3><code>jurisdiction</code> and <code>doc_type</code> Values</h3>
  <p>Both <code>jurisdiction</code> and <code>doc_type</code> are stored as plain <code>TEXT</code> columns in PostgreSQL. Any string value is accepted &mdash; there is no fixed enum. Common conventions:</p>
  <ul>
    <li><strong>Jurisdiction</strong>: Use ISO-style country codes such as <code>CA</code>, <code>US</code>, <code>EU</code>, <code>UK</code>, <code>SG</code>, <code>AU</code>, <code>JP</code>, etc. You can use any value that makes sense for your domain.</li>
    <li><strong>Document type</strong>: Common values include <code>regulation</code>, <code>standard</code>, <code>guidance</code>, <code>act</code>, <code>directive</code>, <code>order</code>, <code>documentation</code>, <code>tutorial</code>, but any string is accepted.</li>
  </ul>
  <p>For generic (non-regulatory) topics, you can omit both fields entirely &mdash; they are nullable in the database.</p>

  <h3>Priority Tiers</h3>
  <p>Priority tiers provide recommended crawl parameters:</p>
  <table>
    <tr><th>Tier</th><th>Description</th><th>Recommended Depth</th><th>Recommended Max Pages</th><th>Recommended Delay</th></tr>
    <tr><td><code>P1</code></td><td>Primary authoritative sources</td><td>3</td><td>100</td><td>1500ms</td></tr>
    <tr><td><code>P2</code></td><td>Secondary documentation and standards</td><td>2</td><td>50</td><td>1500ms</td></tr>
    <tr><td><code>P3</code></td><td>Supporting guides, FAQs, tutorials</td><td>1</td><td>25</td><td>2000ms</td></tr>
    <tr><td><code>P4</code></td><td>Reference material, community resources</td><td>1</td><td>15</td><td>2000ms</td></tr>
  </table>
  <p>The <code>depth</code>, <code>max_pages</code>, and <code>delay</code> fields on each source override the tier defaults. If a source does not specify these fields, you should pass the tier defaults to the crawler manually.</p>
</section>

<!-- Defaults Object -->
<section id="defaults-object">
  <h2>Defaults Object</h2>
  <p>The <code>defaults</code> object provides fallback metadata for chunks that cannot be matched to a specific source.</p>
  <table>
    <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    <tr><td><code>jurisdiction</code></td><td>string</td><td>Default jurisdiction code (optional for generic topics)</td></tr>
    <tr><td><code>authority</code></td><td>string</td><td>Default authority/organization name (optional for generic topics)</td></tr>
    <tr><td><code>doc_type</code></td><td>string</td><td>Default document type (optional for generic topics)</td></tr>
  </table>
  <p>Example (regulatory):</p>
  <pre><code>&quot;defaults&quot;: {
  &quot;jurisdiction&quot;: &quot;SG&quot;,
  &quot;authority&quot;: &quot;SFA&quot;,
  &quot;doc_type&quot;: &quot;regulation&quot;
}</code></pre>
  <p>Example (generic):</p>
  <pre><code>&quot;defaults&quot;: {}</code></pre>
  <p>When the database loader cannot match a chunk file path to any source's <code>source_name</code>, it uses these defaults. A warning is printed for each unmatched document.</p>
</section>

<!-- Coverage Object -->
<section id="coverage-object">
  <h2>Coverage Object</h2>
  <p>The <code>coverage</code> object tracks which sub-domains or topic areas are addressed by the sources in the manifest. This is used during the source discovery phase to identify gaps.</p>
  <table>
    <tr><th>Field</th><th>Type</th><th>Description</th></tr>
    <tr><td><code>covered</code></td><td>array</td><td>List of sub-domain strings that have at least one source</td></tr>
    <tr><td><code>gaps</code></td><td>array</td><td>List of sub-domain strings with no source</td></tr>
    <tr><td><code>coverage_pct</code></td><td>number</td><td>Percentage of the sub-domain checklist that is covered</td></tr>
  </table>
  <p>Example:</p>
  <pre><code>&quot;coverage&quot;: {
  &quot;covered&quot;: [
    &quot;food_safety&quot;, &quot;labelling&quot;, &quot;nutrition&quot;, &quot;additives&quot;,
    &quot;import_export&quot;, &quot;halal&quot;, &quot;novel_food&quot;, &quot;packaging&quot;
  ],
  &quot;gaps&quot;: [&quot;organic&quot;, &quot;alcoholic_beverages&quot;, &quot;weights_measures&quot;],
  &quot;coverage_pct&quot;: 85
}</code></pre>
  <p>The sub-domain checklist is defined by the active domain profile. For regulatory profiles, these are regulatory sub-areas (e.g., food safety, labeling, allergens). For generic topics, these are topic-specific areas generated during the ontology phase.</p>
</section>

<!-- Generic Topic Example -->
<section id="generic-topic-example">
  <h2>Generic Topic Example</h2>
  <p>A manifest for a non-regulatory topic like &quot;kubernetes networking&quot;:</p>
  <pre><code>{
  &quot;topic&quot;: &quot;Kubernetes networking&quot;,
  &quot;graph_name&quot;: &quot;kg_k8s_net&quot;,
  &quot;created_at&quot;: &quot;2026-02-20T10:00:00Z&quot;,
  &quot;sources&quot;: [
    {
      &quot;source_name&quot;: &quot;k8s_networking_docs&quot;,
      &quot;url&quot;: &quot;https://kubernetes.io/docs/concepts/services-networking/&quot;,
      &quot;title&quot;: &quot;Kubernetes Networking Concepts&quot;,
      &quot;priority&quot;: &quot;P1&quot;,
      &quot;sub_domains&quot;: [&quot;services&quot;, &quot;ingress&quot;, &quot;network_policies&quot;],
      &quot;depth&quot;: 3,
      &quot;max_pages&quot;: 80,
      &quot;delay&quot;: 1500
    },
    {
      &quot;source_name&quot;: &quot;cilium_docs&quot;,
      &quot;url&quot;: &quot;https://docs.cilium.io/en/stable/&quot;,
      &quot;title&quot;: &quot;Cilium CNI Documentation&quot;,
      &quot;priority&quot;: &quot;P2&quot;,
      &quot;sub_domains&quot;: [&quot;cni&quot;, &quot;ebpf&quot;, &quot;network_policies&quot;],
      &quot;depth&quot;: 2,
      &quot;max_pages&quot;: 50,
      &quot;delay&quot;: 1500
    }
  ],
  &quot;defaults&quot;: {},
  &quot;coverage&quot;: {
    &quot;covered&quot;: [&quot;services&quot;, &quot;ingress&quot;, &quot;network_policies&quot;, &quot;cni&quot;, &quot;ebpf&quot;],
    &quot;gaps&quot;: [&quot;dns&quot;, &quot;load_balancing&quot;],
    &quot;coverage_pct&quot;: 70
  }
}</code></pre>
  <p>Note: <code>authority</code>, <code>jurisdiction</code>, and <code>doc_type</code> are omitted &mdash; they are nullable in the database.</p>
</section>

<!-- Regulatory Example -->
<section id="regulatory-example">
  <h2>Regulatory Example</h2>
  <pre><code>{
  &quot;topic&quot;: &quot;Full regulatory compliance landscape of Canada for food and beverage&quot;,
  &quot;graph_name&quot;: &quot;reg_ca_fb&quot;,
  &quot;created_at&quot;: &quot;2026-02-18T10:00:00Z&quot;,
  &quot;sources&quot;: [
    {
      &quot;source_name&quot;: &quot;fdr&quot;,
      &quot;url&quot;: &quot;https://laws-lois.justice.gc.ca/eng/regulations/C.R.C.,_c._870/&quot;,
      &quot;title&quot;: &quot;Food and Drug Regulations (C.R.C., c. 870)&quot;,
      &quot;authority&quot;: &quot;CFIA&quot;,
      &quot;jurisdiction&quot;: &quot;CA&quot;,
      &quot;doc_type&quot;: &quot;regulation&quot;,
      &quot;priority&quot;: &quot;P1&quot;,
      &quot;sub_domains&quot;: [&quot;labelling&quot;, &quot;composition&quot;, &quot;additives&quot;, &quot;standards&quot;],
      &quot;depth&quot;: 3,
      &quot;max_pages&quot;: 100,
      &quot;delay&quot;: 1500
    },
    {
      &quot;source_name&quot;: &quot;fda&quot;,
      &quot;url&quot;: &quot;https://laws-lois.justice.gc.ca/eng/acts/F-27/&quot;,
      &quot;title&quot;: &quot;Food and Drugs Act (R.S.C., 1985, c. F-27)&quot;,
      &quot;authority&quot;: &quot;Parliament&quot;,
      &quot;jurisdiction&quot;: &quot;CA&quot;,
      &quot;doc_type&quot;: &quot;act&quot;,
      &quot;priority&quot;: &quot;P1&quot;,
      &quot;sub_domains&quot;: [&quot;food_safety&quot;, &quot;enforcement&quot;, &quot;prohibition&quot;],
      &quot;depth&quot;: 2,
      &quot;max_pages&quot;: 50,
      &quot;delay&quot;: 1500
    },
    {
      &quot;source_name&quot;: &quot;sfcr&quot;,
      &quot;url&quot;: &quot;https://laws-lois.justice.gc.ca/eng/regulations/SOR-2018-108/&quot;,
      &quot;title&quot;: &quot;Safe Food for Canadians Regulations&quot;,
      &quot;authority&quot;: &quot;CFIA&quot;,
      &quot;jurisdiction&quot;: &quot;CA&quot;,
      &quot;doc_type&quot;: &quot;regulation&quot;,
      &quot;priority&quot;: &quot;P1&quot;,
      &quot;sub_domains&quot;: [&quot;food_safety&quot;, &quot;import_export&quot;, &quot;licensing&quot;, &quot;traceability&quot;],
      &quot;depth&quot;: 3,
      &quot;max_pages&quot;: 80,
      &quot;delay&quot;: 1500
    }
  ],
  &quot;defaults&quot;: {
    &quot;jurisdiction&quot;: &quot;CA&quot;,
    &quot;authority&quot;: &quot;CFIA&quot;,
    &quot;doc_type&quot;: &quot;regulation&quot;
  },
  &quot;coverage&quot;: {
    &quot;covered&quot;: [
      &quot;food_safety&quot;, &quot;labelling&quot;, &quot;composition&quot;, &quot;additives&quot;,
      &quot;import_export&quot;, &quot;licensing&quot;, &quot;enforcement&quot;, &quot;prohibition&quot;,
      &quot;standards&quot;, &quot;traceability&quot;
    ],
    &quot;gaps&quot;: [
      &quot;organic&quot;, &quot;halal&quot;, &quot;alcoholic_beverages&quot;, &quot;novel_food&quot;,
      &quot;packaging&quot;, &quot;weights_measures&quot;
    ],
    &quot;coverage_pct&quot;: 50
  }
}</code></pre>
</section>

<!-- Manifest Location -->
<section id="manifest-location">
  <h2>Manifest Location</h2>
  <p>The manifest is typically saved in the pipeline working directory:</p>
  <pre><code>pipelines/
  kg_k8s_net_20260220/           # Generic topic
    crawl_manifest.json
    ontology.yaml                 # Auto-generated ontology
    crawl_output/
      k8s_networking_docs/
      cilium_docs/
    chunk_output/
      k8s_networking_docs/
      cilium_docs/

  reg_sg_fb_20260218/            # Regulatory topic
    crawl_manifest.json
    crawl_output/
      sfa_food_regs/
      sso_sale_of_food_act/
    chunk_output/
      sfa_food_regs/
      sso_sale_of_food_act/</code></pre>
  <p>Example manifests are available in <code>examples/manifests/</code>:</p>
  <ul>
    <li><code>singapore-fb.json</code> &mdash; Singapore F&amp;B regulations (12 sources)</li>
    <li><code>canada-food.json</code> &mdash; Canadian food regulations (3 core sources)</li>
  </ul>
</section>

<!-- Creating a Manifest -->
<section id="creating-a-manifest">
  <h2>Creating a Manifest</h2>
  <p>You can create a manifest in three ways:</p>
  <ol>
    <li><strong>Claude Code <code>/build-kg</code> skill</strong> (recommended): The skill's Phase 1 (Source Discovery) automatically generates a manifest after researching and presenting sources for approval.</li>
    <li><strong>Manually</strong>: Write the JSON file based on your research.</li>
    <li><strong>Copy and modify an example</strong>: Start from <code>examples/manifests/</code> and adjust URLs and sources for your topic.</li>
  </ol>
</section>

<footer>
  <p>build-kg &mdash; Apache 2.0 License &mdash; <a href="https://github.com/agtm1199/build-kg">GitHub</a></p>
</footer>

</div>
</body>
</html>
